<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI ì•„ë°”íƒ€ ì˜ìƒ ë…¹í™”</title>
    <link rel="icon" href="data:,">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.5.4/socket.io.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            min-height: 100vh;
            color: #fff;
        }

        .container {
            max-width: 1800px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            text-align: center;
            padding: 15px 0;
        }

        header h1 {
            font-size: 2.2em;
            background: linear-gradient(90deg, #ff6b6b, #feca57);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 8px;
        }

        header p {
            color: #888;
            font-size: 1.1em;
        }

        .nav-links {
            margin-top: 12px;
        }

        .nav-links a {
            color: #00d2ff;
            text-decoration: none;
            margin: 0 15px;
            font-size: 1em;
        }

        .nav-links a:hover {
            text-decoration: underline;
        }

        /* íƒ­ ë„¤ë¹„ê²Œì´ì…˜ */
        .tab-nav {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin: 20px 0;
        }

        .tab-btn {
            padding: 12px 30px;
            border: none;
            border-radius: 25px;
            background: rgba(255, 255, 255, 0.1);
            color: #aaa;
            font-size: 1em;
            cursor: pointer;
            transition: all 0.3s;
        }

        .tab-btn:hover {
            background: rgba(255, 255, 255, 0.15);
        }

        .tab-btn.active {
            background: linear-gradient(90deg, #ff6b6b, #feca57);
            color: #fff;
            font-weight: bold;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 25px;
            margin-top: 20px;
        }

        .panel {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 16px;
            padding: 20px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .panel h2 {
            font-size: 1.3em;
            margin-bottom: 15px;
            color: #feca57;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: block;
            margin-bottom: 6px;
            color: #aaa;
            font-size: 0.95em;
        }

        select, input, textarea, button {
            width: 100%;
            padding: 12px 16px;
            border-radius: 8px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            background: rgba(255, 255, 255, 0.1);
            color: #fff;
            font-size: 1em;
            transition: all 0.3s;
        }

        textarea {
            min-height: 150px;
            resize: vertical;
            font-family: inherit;
            line-height: 1.5;
        }

        textarea.batch-input {
            min-height: 300px;
            font-family: 'Consolas', monospace;
            font-size: 0.9em;
        }

        select:hover, select:focus,
        input:hover, input:focus,
        textarea:hover, textarea:focus {
            border-color: #feca57;
            outline: none;
        }

        select option {
            background: #1a1a2e;
            color: #fff;
        }

        button.primary {
            background: linear-gradient(90deg, #ff6b6b, #feca57);
            border: none;
            font-weight: bold;
            cursor: pointer;
            margin-top: 8px;
        }

        button.primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(254, 202, 87, 0.4);
        }

        button.primary:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        button.secondary {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.3);
            cursor: pointer;
        }

        button.secondary:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        button.danger {
            background: linear-gradient(90deg, #e74c3c, #c0392b);
            border: none;
            cursor: pointer;
        }

        .video-container {
            position: relative;
            width: 100%;
            aspect-ratio: 16/9;
            background: #000;
            border-radius: 12px;
            overflow: hidden;
            margin-bottom: 15px;
        }

        .video-container video {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }

        .progress-container {
            margin-top: 15px;
            display: none;
        }

        .progress-bar {
            height: 6px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 3px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #ff6b6b, #feca57);
            width: 0%;
            transition: width 0.3s;
        }

        .status-text {
            display: flex;
            justify-content: space-between;
            margin-top: 8px;
            color: #aaa;
            font-size: 0.9em;
        }

        .settings-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
        }

        .settings-row-3 {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 12px;
        }

        /* ë°°ì¹˜ ì‘ì—… ëª©ë¡ */
        .batch-list {
            max-height: 400px;
            overflow-y: auto;
            margin-top: 15px;
        }

        .batch-item {
            display: flex;
            align-items: center;
            padding: 12px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            margin-bottom: 8px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            gap: 12px;
        }

        .batch-item.processing {
            border-color: #feca57;
            background: rgba(254, 202, 87, 0.1);
        }

        .batch-item.completed {
            border-color: #4caf50;
            background: rgba(76, 175, 80, 0.1);
        }

        .batch-item.error {
            border-color: #e74c3c;
            background: rgba(231, 76, 60, 0.1);
        }

        .batch-item .number {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 0.85em;
            flex-shrink: 0;
        }

        .batch-item.completed .number {
            background: #4caf50;
        }

        .batch-item.processing .number {
            background: #feca57;
            color: #000;
        }

        .batch-item .info {
            flex: 1;
            min-width: 0;
        }

        .batch-item .text {
            font-size: 0.9em;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            color: #fff;
        }

        .batch-item .meta {
            font-size: 0.8em;
            color: #888;
            margin-top: 3px;
        }

        .batch-item .actions {
            display: flex;
            gap: 6px;
            flex-shrink: 0;
        }

        .batch-item .actions button {
            width: auto;
            padding: 6px 12px;
            font-size: 0.8em;
        }

        .btn-play {
            background: linear-gradient(90deg, #00d2ff, #3a7bd5) !important;
            border: none !important;
        }

        .btn-download {
            background: linear-gradient(90deg, #11998e, #38ef7d) !important;
            border: none !important;
        }

        /* ë°°ì¹˜ ì§„í–‰ ìƒí™© */
        .batch-progress {
            background: rgba(254, 202, 87, 0.1);
            border: 1px solid rgba(254, 202, 87, 0.3);
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
            display: none;
        }

        .batch-progress.active {
            display: block;
        }

        .batch-progress-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .batch-progress-title {
            font-weight: bold;
            color: #feca57;
        }

        .batch-progress-count {
            color: #aaa;
            font-size: 0.9em;
        }

        .batch-progress-bar {
            height: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            overflow: hidden;
        }

        .batch-progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #ff6b6b, #feca57);
            width: 0%;
            transition: width 0.5s;
        }

        .batch-progress-status {
            margin-top: 8px;
            font-size: 0.9em;
            color: #aaa;
        }

        /* ë¹„ë””ì˜¤ ëª©ë¡ */
        .video-list {
            max-height: 250px;
            overflow-y: auto;
            margin-top: 15px;
        }

        .video-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 12px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            margin-bottom: 8px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .video-item:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .video-item .info {
            flex: 1;
        }

        .video-item .name {
            font-weight: bold;
            color: #fff;
            font-size: 0.95em;
        }

        .video-item .meta {
            font-size: 0.8em;
            color: #888;
            margin-top: 2px;
        }

        .video-item .actions {
            display: flex;
            gap: 6px;
        }

        .video-item .actions button {
            width: auto;
            padding: 6px 12px;
            font-size: 0.85em;
        }

        .char-count {
            text-align: right;
            font-size: 0.85em;
            color: #888;
            margin-top: 4px;
        }

        .char-count.warning {
            color: #ff6b6b;
        }

        .tips {
            background: rgba(0, 210, 255, 0.1);
            border: 1px solid rgba(0, 210, 255, 0.3);
            border-radius: 8px;
            padding: 12px;
            margin-top: 15px;
        }

        .tips h3 {
            color: #00d2ff;
            margin-bottom: 8px;
            font-size: 1em;
        }

        .tips ul {
            list-style: none;
            padding: 0;
        }

        .tips li {
            padding: 4px 0;
            color: #aaa;
            font-size: 0.9em;
        }

        .tips li::before {
            content: "â€¢";
            color: #00d2ff;
            margin-right: 8px;
        }

        .queue-status {
            display: none;
            align-items: center;
            gap: 12px;
            padding: 12px;
            background: rgba(254, 202, 87, 0.1);
            border-radius: 8px;
            margin-top: 12px;
            border: 1px solid rgba(254, 202, 87, 0.3);
        }

        .queue-spinner {
            width: 20px;
            height: 20px;
            border: 2px solid rgba(254, 202, 87, 0.3);
            border-top-color: #feca57;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .queue-message {
            font-weight: bold;
            color: #feca57;
            font-size: 0.95em;
        }

        /* ì „ì²´ ë‹¤ìš´ë¡œë“œ ë²„íŠ¼ */
        .download-all-btn {
            background: linear-gradient(90deg, #11998e, #38ef7d) !important;
            margin-top: 10px;
        }

        /* íŒŒì¼ ì—…ë¡œë“œ ì˜ì—­ */
        .file-drop-zone {
            border: 2px dashed rgba(255, 255, 255, 0.3);
            border-radius: 12px;
            padding: 40px 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            background: rgba(255, 255, 255, 0.02);
        }

        .file-drop-zone:hover {
            border-color: #feca57;
            background: rgba(254, 202, 87, 0.05);
        }

        .file-drop-zone.dragover {
            border-color: #feca57;
            background: rgba(254, 202, 87, 0.1);
        }

        .file-icon {
            font-size: 3em;
            margin-bottom: 10px;
        }

        .file-text {
            color: #fff;
            font-size: 1.1em;
            margin-bottom: 5px;
        }

        .file-info {
            color: #888;
            font-size: 0.9em;
        }

        .selected-file {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 15px;
            background: rgba(76, 175, 80, 0.1);
            border: 1px solid rgba(76, 175, 80, 0.3);
            border-radius: 8px;
            margin-top: 10px;
        }

        .selected-file .file-name {
            flex: 1;
            color: #4caf50;
            font-weight: bold;
        }

        .selected-file .file-size {
            color: #888;
            font-size: 0.9em;
        }

        .selected-file .file-remove {
            width: 30px;
            height: 30px;
            padding: 0;
            border-radius: 50%;
            background: rgba(231, 76, 60, 0.2);
            border: 1px solid rgba(231, 76, 60, 0.5);
            color: #e74c3c;
            cursor: pointer;
            font-size: 1em;
        }

        .selected-file .file-remove:hover {
            background: rgba(231, 76, 60, 0.4);
        }

        /* ì—…ë¡œë“œ ê²°ê³¼ ì¹´ë“œ */
        .result-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 20px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .result-item {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            padding: 10px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }

        .result-item:last-child {
            border-bottom: none;
        }

        .result-label {
            color: #888;
            font-size: 0.9em;
            flex-shrink: 0;
            width: 80px;
        }

        .result-value {
            color: #fff;
            font-size: 0.95em;
            text-align: right;
            flex: 1;
        }

        .result-link {
            color: #00d2ff;
            text-decoration: none;
        }

        .result-link:hover {
            text-decoration: underline;
        }

        @media (max-width: 1200px) {
            .main-content {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>AI ì•„ë°”íƒ€ ì˜ìƒ ë…¹í™”</h1>
            <p>í…ìŠ¤íŠ¸ë¥¼ ì…ë ¥í•˜ë©´ AI ì•„ë°”íƒ€ê°€ ë§í•˜ëŠ” ì˜ìƒì„ ìƒì„±í•©ë‹ˆë‹¤</p>
            <div class="nav-links">
                <a href="/">â† ë©´ì ‘ ì‹œë®¬ë ˆì´ì…˜</a>
                <a href="/record">ì˜ìƒ ë…¹í™”</a>
            </div>
        </header>

        <!-- íƒ­ ë„¤ë¹„ê²Œì´ì…˜ -->
        <div class="tab-nav">
            <button class="tab-btn active" onclick="switchTab('single')">ë‹¨ì¼ ë…¹í™”</button>
            <button class="tab-btn" onclick="switchTab('batch')">ëŒ€ëŸ‰ ë…¹í™”</button>
            <button class="tab-btn" onclick="switchTab('upload')">ìºì‹œ ì—…ë¡œë“œ</button>
        </div>

        <!-- ë‹¨ì¼ ë…¹í™” íƒ­ -->
        <div id="singleTab" class="tab-content active">
            <div class="main-content">
                <!-- ì™¼ìª½: ì…ë ¥ íŒ¨ë„ -->
                <div class="panel">
                    <h2>í…ìŠ¤íŠ¸ ì…ë ¥</h2>

                    <div class="settings-row">
                        <div class="form-group">
                            <label>TTS ì—”ì§„</label>
                            <select id="ttsEngineSelect" onchange="updateVoiceOptions()">
                                <option value="">ë¡œë”© ì¤‘...</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>ìŒì„±</label>
                            <select id="ttsVoiceSelect">
                                <option value="">ì—”ì§„ ì„ íƒ</option>
                            </select>
                        </div>
                    </div>

                    <div class="settings-row">
                        <div class="form-group">
                            <label>ì¶œë ¥ í•´ìƒë„</label>
                            <select id="resolutionSelect">
                                <option value="720p" selected>720p (ê³ í’ˆì§ˆ)</option>
                                <option value="480p">480p (ê¶Œì¥)</option>
                                <option value="360p">360p (ë¹ ë¥¸ ì†ë„)</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>ì¶œë ¥ í¬ë§·</label>
                            <select id="formatSelect">
                                <option value="mp4" selected>MP4 (í˜¸í™˜ì„±)</option>
                                <option value="webm">WebM (ì›¹ ìµœì í™”)</option>
                            </select>
                        </div>
                    </div>

                    <div class="settings-row">
                        <div class="form-group">
                            <label>ì†ë„/í’ˆì§ˆ</label>
                            <select id="frameSkipSelect">
                                <option value="1" selected>ê³ í’ˆì§ˆ (ê¸°ë³¸)</option>
                                <option value="2">ë¹ ë¦„ (2ë°°ì†)</option>
                                <option value="3">ìµœê³ ì† (3ë°°ì†)</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>íŒŒì¼ëª… (ì„ íƒ)</label>
                            <input type="text" id="filenameInput" placeholder="ìë™ ìƒì„±">
                        </div>
                    </div>

                    <div class="form-group">
                        <label>ëŒ€ì‚¬ ì…ë ¥</label>
                        <select id="exampleTextSelect" onchange="selectExampleText()" style="width: 100%; padding: 10px; margin-bottom: 8px; border-radius: 8px; border: 1px solid #333; background: #1e1e1e; color: #fff; font-size: 0.9rem;">
                            <option value="">í…ŒìŠ¤íŠ¸ ì˜ˆì‹œ ì„ íƒ...</option>
                            <option value="ì•ˆë…•í•˜ì„¸ìš”">ì§§ì€ ì¸ì‚¬ (1ë¬¸ì¥)</option>
                            <option value="ì•ˆë…•í•˜ì„¸ìš”. ë§Œë‚˜ì„œ ë°˜ê°‘ìŠµë‹ˆë‹¤.">ê¸°ë³¸ ì¸ì‚¬ (2ë¬¸ì¥)</option>
                            <option value="ì•ˆë…•í•˜ì„¸ìš”. ì €ëŠ” AI ë©´ì ‘ê´€ì…ë‹ˆë‹¤. ì˜¤ëŠ˜ ë©´ì ‘ì— ì°¸ì„í•´ ì£¼ì…”ì„œ ê°ì‚¬í•©ë‹ˆë‹¤.">ê¸´ ì¸ì‚¬ (3ë¬¸ì¥)</option>
                            <option value="ìê¸°ì†Œê°œë¥¼ í•´ ì£¼ì‹œê² ì–´ìš”?">ë©´ì ‘ ì§ˆë¬¸ - ìê¸°ì†Œê°œ</option>
                            <option value="ì§€ì› ë™ê¸°ì— ëŒ€í•´ ë§ì”€í•´ ì£¼ì„¸ìš”.">ë©´ì ‘ ì§ˆë¬¸ - ì§€ì› ë™ê¸°</option>
                            <option value="ë³¸ì¸ì˜ ê°•ì ê³¼ ì•½ì ì— ëŒ€í•´ ë§ì”€í•´ ì£¼ì„¸ìš”.">ë©´ì ‘ ì§ˆë¬¸ - ê°•ì /ì•½ì </option>
                            <option value="5ë…„ í›„ ìì‹ ì˜ ëª¨ìŠµì„ ì–´ë–»ê²Œ ê·¸ë¦¬ê³  ê³„ì‹ ê°€ìš”?">ë©´ì ‘ ì§ˆë¬¸ - ë¯¸ë˜ ë¹„ì „</option>
                            <option value="ë§ˆì§€ë§‰ìœ¼ë¡œ í•˜ê³  ì‹¶ì€ ë§ì”€ì´ ìˆìœ¼ì‹ ê°€ìš”?">ë©´ì ‘ ì§ˆë¬¸ - ë§ˆë¬´ë¦¬</option>
                            <option value="ë„¤, ì¢‹ì€ ë‹µë³€ ê°ì‚¬í•©ë‹ˆë‹¤. ë‹¤ìŒ ì§ˆë¬¸ìœ¼ë¡œ ë„˜ì–´ê°€ê² ìŠµë‹ˆë‹¤.">ë©´ì ‘ê´€ í”¼ë“œë°±</option>
                            <option value="ì˜¤ëŠ˜ ë©´ì ‘ì€ ì—¬ê¸°ê¹Œì§€ì…ë‹ˆë‹¤. ê²°ê³¼ëŠ” ì¶”í›„ ê°œë³„ ì—°ë½ ë“œë¦¬ê² ìŠµë‹ˆë‹¤. ìˆ˜ê³ í•˜ì…¨ìŠµë‹ˆë‹¤.">ë©´ì ‘ ì¢…ë£Œ ë©˜íŠ¸</option>
                        </select>
                        <textarea id="scriptInput" placeholder="ì•„ë°”íƒ€ê°€ ë§í•  ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”..."></textarea>
                        <div class="char-count" id="charCount">0 / 1000ì</div>
                    </div>

                    <button class="primary" id="generateBtn" onclick="generateVideo()">
                        ğŸ¬ ì˜ìƒ ìƒì„±
                    </button>

                    <div class="progress-container" id="progressContainer">
                        <div class="progress-bar">
                            <div class="progress-fill" id="progressFill"></div>
                        </div>
                        <div class="status-text">
                            <span id="statusText">ì¤€ë¹„ ì¤‘...</span>
                            <span id="elapsedTime"></span>
                        </div>
                    </div>

                    <div class="queue-status" id="queueStatus">
                        <div class="queue-spinner"></div>
                        <div class="queue-message" id="queueMessage">ëŒ€ê¸° ì¤‘...</div>
                    </div>
                </div>

                <!-- ì˜¤ë¥¸ìª½: ë¯¸ë¦¬ë³´ê¸° -->
                <div class="panel">
                    <h2>ë¯¸ë¦¬ë³´ê¸°</h2>
                    <div class="video-container">
                        <video id="previewVideo" controls></video>
                    </div>
                    <div style="display: flex; gap: 10px;">
                        <button class="btn-download secondary" id="downloadBtn" onclick="downloadVideo()" disabled>
                            ğŸ“¥ ë‹¤ìš´ë¡œë“œ
                        </button>
                        <button class="secondary" onclick="copyVideoUrl()" id="copyUrlBtn" disabled>
                            ğŸ”— URL ë³µì‚¬
                        </button>
                        <button class="secondary" id="loopBtn" onclick="toggleLoop()" disabled>
                            ğŸ” ë°˜ë³µ ì¬ìƒ
                        </button>
                    </div>

                    <h2 style="margin-top: 20px;">ìƒì„±ëœ ì˜ìƒ</h2>
                    <div class="video-list" id="videoList">
                        <p style="color: #888; text-align: center; padding: 15px;">
                            ì•„ì§ ìƒì„±ëœ ì˜ìƒì´ ì—†ìŠµë‹ˆë‹¤
                        </p>
                    </div>
                </div>
            </div>
        </div>

        <!-- ëŒ€ëŸ‰ ë…¹í™” íƒ­ -->
        <div id="batchTab" class="tab-content">
            <div class="main-content">
                <!-- ì™¼ìª½: ë°°ì¹˜ ì…ë ¥ -->
                <div class="panel">
                    <h2>ëŒ€ëŸ‰ í…ìŠ¤íŠ¸ ì…ë ¥</h2>

                    <div class="settings-row-3">
                        <div class="form-group">
                            <label>TTS ì—”ì§„</label>
                            <select id="batchTtsEngineSelect" onchange="updateBatchVoiceOptions()">
                                <option value="">ë¡œë”© ì¤‘...</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>ìŒì„±</label>
                            <select id="batchTtsVoiceSelect">
                                <option value="">ì—”ì§„ ì„ íƒ</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>í•´ìƒë„</label>
                            <select id="batchResolutionSelect">
                                <option value="720p" selected>720p (ê³ í’ˆì§ˆ)</option>
                                <option value="480p">480p</option>
                                <option value="360p">360p</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>í¬ë§·</label>
                            <select id="batchFormatSelect">
                                <option value="mp4" selected>MP4</option>
                                <option value="webm">WebM</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>ì†ë„</label>
                            <select id="batchFrameSkipSelect">
                                <option value="1" selected>ê³ í’ˆì§ˆ</option>
                                <option value="2">2ë°°ì†</option>
                                <option value="3">3ë°°ì†</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>ëŒ€ì‚¬ ëª©ë¡ (í•œ ì¤„ì— í•˜ë‚˜ì”©, ë¹ˆ ì¤„ì€ ë¬´ì‹œ)</label>
                        <textarea id="batchInput" class="batch-input" placeholder="ê° ì¤„ì— í•˜ë‚˜ì˜ ëŒ€ì‚¬ë¥¼ ì…ë ¥í•˜ì„¸ìš”. ì˜ˆ:

ì•ˆë…•í•˜ì„¸ìš”, ë°˜ê°‘ìŠµë‹ˆë‹¤.
ì˜¤ëŠ˜ ë©´ì ‘ì— ì˜¤ì‹  ê²ƒì„ í™˜ì˜í•©ë‹ˆë‹¤.
ë¨¼ì € ìê¸°ì†Œê°œ ë¶€íƒë“œë¦½ë‹ˆë‹¤.
ì§€ì› ë™ê¸°ë¥¼ ë§ì”€í•´ ì£¼ì„¸ìš”.
ë§ˆì§€ë§‰ìœ¼ë¡œ ì§ˆë¬¸ ìˆìœ¼ì‹ ê°€ìš”?

---
ë˜ëŠ” ë²ˆí˜¸ í˜•ì‹ë„ ê°€ëŠ¥í•©ë‹ˆë‹¤:
1. ì²« ë²ˆì§¸ ëŒ€ì‚¬
2. ë‘ ë²ˆì§¸ ëŒ€ì‚¬
3. ì„¸ ë²ˆì§¸ ëŒ€ì‚¬"></textarea>
                        <div style="display: flex; justify-content: space-between; margin-top: 5px;">
                            <span class="char-count" id="batchLineCount">0ê°œ í•­ëª©</span>
                            <button class="secondary" style="width: auto; padding: 6px 15px; font-size: 0.85em;" onclick="parseBatchInput()">
                                ğŸ“‹ í•­ëª© í™•ì¸
                            </button>
                        </div>
                    </div>

                    <div class="settings-row">
                        <button class="primary" id="batchStartBtn" onclick="startBatchRecording()">
                            ğŸš€ ëŒ€ëŸ‰ ë…¹í™” ì‹œì‘
                        </button>
                        <button class="danger secondary" id="batchStopBtn" onclick="stopBatchRecording()" disabled>
                            â¹ ì¤‘ì§€
                        </button>
                    </div>

                    <div class="tips">
                        <h3>ğŸ’¡ ëŒ€ëŸ‰ ë…¹í™” íŒ</h3>
                        <ul>
                            <li>í•œ ì¤„ì— í•˜ë‚˜ì˜ ëŒ€ì‚¬ë¥¼ ì…ë ¥í•˜ì„¸ìš”</li>
                            <li>ë¹ˆ ì¤„ê³¼ "---" êµ¬ë¶„ì„ ì€ ìë™ìœ¼ë¡œ ë¬´ì‹œë©ë‹ˆë‹¤</li>
                            <li>"1. ", "2) " ë“± ë²ˆí˜¸ ì ‘ë‘ì‚¬ëŠ” ìë™ ì œê±°ë©ë‹ˆë‹¤</li>
                            <li>ìˆœì°¨ì ìœ¼ë¡œ ì²˜ë¦¬ë˜ë©°, ì™„ë£Œëœ ì˜ìƒì€ ë°”ë¡œ ë‹¤ìš´ë¡œë“œ ê°€ëŠ¥í•©ë‹ˆë‹¤</li>
                            <li>ì¤‘ì§€ ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ í˜„ì¬ ì‘ì—… ì™„ë£Œ í›„ ì¤‘ì§€ë©ë‹ˆë‹¤</li>
                        </ul>
                    </div>

                    <div class="tips" style="margin-top: 10px; background: rgba(17, 153, 142, 0.1); border-color: rgba(17, 153, 142, 0.3);">
                        <h3 style="color: #11998e;">ğŸ“ íŒŒì¼ ê´€ë¦¬</h3>
                        <ul>
                            <li>íŒŒì¼ëª…: ëŒ€ì‚¬ ì• 10ê¸€ì + ê³ ìœ ID (ì˜ˆ: ì•ˆë…•í•˜ì„¸ìš”_a1b2c3d4.mp4)</li>
                            <li>JSON íŒŒì¼: ë™ì¼ ì´ë¦„ì˜ .json íŒŒì¼ì— ëŒ€ì‚¬ ì „ì²´ ì €ì¥</li>
                            <li>MP4 ë©”íƒ€ë°ì´í„°: title/comment/descriptionì—ë„ ì €ì¥</li>
                            <li>JSON ë‚´ìš©: text, created_at, resolution, duration ë“±</li>
                        </ul>
                    </div>
                </div>

                <!-- ì˜¤ë¥¸ìª½: ë°°ì¹˜ ì§„í–‰ ìƒí™© -->
                <div class="panel">
                    <h2>ì§„í–‰ ìƒí™©</h2>

                    <div class="batch-progress" id="batchProgress">
                        <div class="batch-progress-header">
                            <span class="batch-progress-title">ëŒ€ëŸ‰ ë…¹í™” ì§„í–‰ ì¤‘</span>
                            <span class="batch-progress-count" id="batchProgressCount">0 / 0</span>
                        </div>
                        <div class="batch-progress-bar">
                            <div class="batch-progress-fill" id="batchProgressFill"></div>
                        </div>
                        <div class="batch-progress-status" id="batchProgressStatus">ì¤€ë¹„ ì¤‘...</div>
                    </div>

                    <div class="batch-list" id="batchList">
                        <p style="color: #888; text-align: center; padding: 20px;">
                            ëŒ€ì‚¬ë¥¼ ì…ë ¥í•˜ê³  "í•­ëª© í™•ì¸" ë²„íŠ¼ì„ ëˆŒëŸ¬ì£¼ì„¸ìš”
                        </p>
                    </div>

                    <button class="download-all-btn primary" id="downloadAllBtn" onclick="downloadAllVideos()" style="display: none;">
                        ğŸ“¦ ì „ì²´ ë‹¤ìš´ë¡œë“œ (ZIP)
                    </button>
                </div>
            </div>
        </div>

        <!-- ìºì‹œ ì—…ë¡œë“œ íƒ­ -->
        <div id="uploadTab" class="tab-content">
            <div class="main-content">
                <!-- ì™¼ìª½: ì—…ë¡œë“œ í¼ -->
                <div class="panel">
                    <h2>ë¹„ë””ì˜¤ ìºì‹œ ì—…ë¡œë“œ</h2>
                    <p style="color: #888; margin-bottom: 15px;">ìƒì„±ëœ ì˜ìƒì„ ì„œë²„ ìºì‹œì— ì—…ë¡œë“œí•˜ì—¬ ë¹ ë¥´ê²Œ ì¬ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>

                    <div class="form-group">
                        <label>API í‚¤ <span style="color: #ff6b6b;">*</span></label>
                        <input type="password" id="uploadApiKey" placeholder="API í‚¤ë¥¼ ì…ë ¥í•˜ì„¸ìš”">
                        <div style="font-size: 0.8em; color: #888; margin-top: 4px;">
                            ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì— ì €ì¥ë˜ì–´ ë‹¤ìŒ ë°©ë¬¸ ì‹œ ìë™ ì…ë ¥ë©ë‹ˆë‹¤
                        </div>
                    </div>

                    <div class="form-group">
                        <label>ëŒ€ì‚¬ í…ìŠ¤íŠ¸ <span style="color: #ff6b6b;">*</span></label>
                        <textarea id="uploadText" placeholder="ì´ ì˜ìƒì— í•´ë‹¹í•˜ëŠ” ëŒ€ì‚¬ë¥¼ ì…ë ¥í•˜ì„¸ìš” (ìºì‹œ í‚¤ ìƒì„±ìš©)"></textarea>
                        <div class="char-count" id="uploadCharCount">0ì</div>
                    </div>

                    <div class="form-group">
                        <label>ë¹„ë””ì˜¤ íŒŒì¼ <span style="color: #ff6b6b;">*</span></label>
                        <div class="file-upload-area" id="fileUploadArea">
                            <input type="file" id="uploadVideoFile" accept="video/mp4,video/webm" style="display: none;" onchange="handleFileSelect(event)">
                            <div class="file-drop-zone" id="fileDropZone" onclick="document.getElementById('uploadVideoFile').click()">
                                <div class="file-icon">ğŸ“</div>
                                <div class="file-text">í´ë¦­í•˜ê±°ë‚˜ íŒŒì¼ì„ ë“œë˜ê·¸í•˜ì—¬ ì—…ë¡œë“œ</div>
                                <div class="file-info">MP4 ë˜ëŠ” WebM (ìµœëŒ€ 100MB)</div>
                            </div>
                            <div class="selected-file" id="selectedFile" style="display: none;">
                                <span class="file-name" id="selectedFileName"></span>
                                <span class="file-size" id="selectedFileSize"></span>
                                <button class="file-remove" onclick="clearFileSelection()">âœ•</button>
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>ì†ŒìŠ¤ ìœ í˜•</label>
                        <select id="uploadSource">
                            <option value="lipsync" selected>Lipsync (ê¸°ë³¸)</option>
                            <option value="heygen">HeyGen</option>
                        </select>
                    </div>

                    <button class="primary" id="uploadBtn" onclick="uploadVideoToCache()">
                        ğŸ“¤ ìºì‹œì— ì—…ë¡œë“œ
                    </button>

                    <div class="progress-container" id="uploadProgressContainer">
                        <div class="progress-bar">
                            <div class="progress-fill" id="uploadProgressFill"></div>
                        </div>
                        <div class="status-text">
                            <span id="uploadStatusText">ì¤€ë¹„ ì¤‘...</span>
                            <span id="uploadProgressPercent"></span>
                        </div>
                    </div>

                    <div class="tips" style="margin-top: 15px;">
                        <h3>ğŸ’¡ ìºì‹œ ì—…ë¡œë“œ ì•ˆë‚´</h3>
                        <ul>
                            <li>ì—…ë¡œë“œëœ ì˜ìƒì€ í…ìŠ¤íŠ¸ ê¸°ë°˜ ìºì‹œ í‚¤ë¡œ ì €ì¥ë©ë‹ˆë‹¤</li>
                            <li>ë™ì¼í•œ í…ìŠ¤íŠ¸ë¡œ ìš”ì²­ ì‹œ ìºì‹œëœ ì˜ìƒì´ ë°˜í™˜ë©ë‹ˆë‹¤</li>
                            <li>MP4, WebM í˜•ì‹ ì§€ì› (ìµœëŒ€ 100MB)</li>
                            <li>ì—…ë¡œë“œ í›„ ë°˜í™˜ëœ URLë¡œ ì˜ìƒì— ì ‘ê·¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤</li>
                        </ul>
                    </div>
                </div>

                <!-- ì˜¤ë¥¸ìª½: ì—…ë¡œë“œ ê²°ê³¼ -->
                <div class="panel">
                    <h2>ì—…ë¡œë“œ ê²°ê³¼</h2>

                    <div id="uploadResultEmpty" style="color: #888; text-align: center; padding: 40px;">
                        ì•„ì§ ì—…ë¡œë“œëœ ì˜ìƒì´ ì—†ìŠµë‹ˆë‹¤
                    </div>

                    <div id="uploadResult" style="display: none;">
                        <div class="result-card">
                            <div class="result-item">
                                <span class="result-label">ìƒíƒœ</span>
                                <span class="result-value" id="resultStatus">-</span>
                            </div>
                            <div class="result-item">
                                <span class="result-label">ìºì‹œ í‚¤</span>
                                <span class="result-value" id="resultCacheKey" style="font-family: monospace; word-break: break-all;">-</span>
                            </div>
                            <div class="result-item">
                                <span class="result-label">ì†ŒìŠ¤</span>
                                <span class="result-value" id="resultSource">-</span>
                            </div>
                            <div class="result-item">
                                <span class="result-label">ë¹„ë””ì˜¤ URL</span>
                                <a class="result-value result-link" id="resultVideoUrl" href="#" target="_blank">-</a>
                            </div>
                        </div>

                        <div style="display: flex; gap: 10px; margin-top: 15px;">
                            <button class="secondary" onclick="copyUploadedUrl()">ğŸ”— URL ë³µì‚¬</button>
                            <button class="btn-play secondary" onclick="previewUploadedVideo()">â–¶ ë¯¸ë¦¬ë³´ê¸°</button>
                        </div>
                    </div>

                    <h2 style="margin-top: 25px;">ì—…ë¡œë“œ ê¸°ë¡</h2>
                    <div class="video-list" id="uploadHistory">
                        <p style="color: #888; text-align: center; padding: 15px;">
                            ì—…ë¡œë“œ ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ì „ì—­ ë³€ìˆ˜
        let socket = null;
        let clientSid = null;
        let ttsEngines = {};
        let currentVideoUrl = null;
        let generatedVideos = [];
        let isLooping = false;  // ë°˜ë³µ ì¬ìƒ ìƒíƒœ

        // ë°°ì¹˜ ê´€ë ¨ ë³€ìˆ˜
        let batchItems = [];
        let batchCurrentIndex = 0;
        let batchRunning = false;
        let batchResults = [];

        // ì´ˆê¸°í™”
        document.addEventListener('DOMContentLoaded', function() {
            initSocket();
            loadOptions();
            setupTextareas();
        });

        // íƒ­ ì „í™˜
        function switchTab(tabName) {
            document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));

            document.querySelector(`.tab-btn[onclick="switchTab('${tabName}')"]`).classList.add('active');
            document.getElementById(tabName + 'Tab').classList.add('active');
        }

        // WebSocket ì´ˆê¸°í™”
        function initSocket() {
            socket = io();

            socket.on('connect', () => {
                console.log('WebSocket ì—°ê²°ë¨');
            });

            socket.on('connected', (data) => {
                clientSid = data.sid;
                console.log('í´ë¼ì´ì–¸íŠ¸ SID:', clientSid);
            });

            socket.on('queue_update', (data) => {
                if (batchRunning) {
                    updateBatchItemStatus(batchCurrentIndex, 'processing', data.message);
                } else {
                    document.getElementById('queueStatus').style.display = 'flex';
                    document.getElementById('queueMessage').textContent = data.message;
                }
            });

            socket.on('status', (data) => {
                if (batchRunning) {
                    updateBatchItemStatus(batchCurrentIndex, 'processing', data.message);
                    document.getElementById('batchProgressStatus').textContent =
                        `[${batchCurrentIndex + 1}/${batchItems.length}] ${data.message}`;
                } else {
                    document.getElementById('progressContainer').style.display = 'block';
                    document.getElementById('queueStatus').style.display = 'none';
                    document.getElementById('statusText').textContent = data.message;
                    document.getElementById('progressFill').style.width = data.progress + '%';
                    if (data.elapsed) {
                        document.getElementById('elapsedTime').textContent = data.elapsed.toFixed(1) + 'ì´ˆ';
                    }
                }
            });

            socket.on('complete', (data) => {
                console.log('ìƒì„± ì™„ë£Œ:', data);

                if (batchRunning) {
                    // ë°°ì¹˜ ëª¨ë“œ
                    batchResults[batchCurrentIndex] = {
                        url: data.video_url,
                        success: true
                    };
                    updateBatchItemStatus(batchCurrentIndex, 'completed', 'ì™„ë£Œ', data.video_url);

                    // ë‹¤ìŒ í•­ëª© ì²˜ë¦¬
                    batchCurrentIndex++;
                    updateBatchProgress();

                    if (batchCurrentIndex < batchItems.length && batchRunning) {
                        setTimeout(() => processNextBatchItem(), 500);
                    } else {
                        finishBatchRecording();
                    }
                } else {
                    // ë‹¨ì¼ ëª¨ë“œ
                    document.getElementById('progressFill').style.width = '100%';
                    document.getElementById('statusText').textContent = 'ì™„ë£Œ!';
                    document.getElementById('generateBtn').disabled = false;
                    document.getElementById('generateBtn').textContent = 'ğŸ¬ ì˜ìƒ ìƒì„±';

                    currentVideoUrl = data.video_url;
                    const previewVideo = document.getElementById('previewVideo');
                    previewVideo.src = currentVideoUrl + '?' + Date.now();
                    previewVideo.load();
                    previewVideo.play();

                    document.getElementById('downloadBtn').disabled = false;
                    document.getElementById('copyUrlBtn').disabled = false;

                    addVideoToList(data);

                    setTimeout(() => {
                        document.getElementById('progressContainer').style.display = 'none';
                    }, 3000);
                }
            });

            socket.on('error', (data) => {
                console.error('ì˜¤ë¥˜:', data);

                if (batchRunning) {
                    batchResults[batchCurrentIndex] = {
                        success: false,
                        error: data.message
                    };
                    updateBatchItemStatus(batchCurrentIndex, 'error', 'ì˜¤ë¥˜: ' + data.message);

                    batchCurrentIndex++;
                    updateBatchProgress();

                    if (batchCurrentIndex < batchItems.length && batchRunning) {
                        setTimeout(() => processNextBatchItem(), 500);
                    } else {
                        finishBatchRecording();
                    }
                } else {
                    document.getElementById('statusText').textContent = 'ì˜¤ë¥˜: ' + data.message;
                    document.getElementById('generateBtn').disabled = false;
                    document.getElementById('generateBtn').textContent = 'ğŸ¬ ì˜ìƒ ìƒì„±';
                    document.getElementById('queueStatus').style.display = 'none';
                }
            });
        }

        // CosyVoice ì—°ê²° í…ŒìŠ¤íŠ¸
        async function checkCosyVoiceConnection() {
            try {
                const response = await fetch('/api/check_cosyvoice', {
                    method: 'GET',
                    timeout: 5000
                });
                const result = await response.json();

                if (!result.connected) {
                    console.error('[CosyVoice] ì—°ê²° ì‹¤íŒ¨:', result.error || 'ì„œë²„ ì‘ë‹µ ì—†ìŒ');
                    console.warn('[CosyVoice] URL:', result.url || 'N/A');
                    return false;
                }
                console.log('[CosyVoice] ì—°ê²° ì„±ê³µ');
                return true;
            } catch (e) {
                console.error('[CosyVoice] ì—°ê²° í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨:', e.message);
                return false;
            }
        }

        // ì˜µì…˜ ë¡œë“œ
        async function loadOptions() {
            try {
                // TTS ì—”ì§„ ë¡œë“œ
                const enginesRes = await fetch('/api/tts_engines');
                const engines = await enginesRes.json();
                ttsEngines = {};
                engines.forEach(e => { ttsEngines[e.id] = e; });

                // CosyVoice ì—°ê²° í…ŒìŠ¤íŠ¸ (1íšŒ ì‹œë„)
                const cosyvoiceEngine = engines.find(e => e.id === 'cosyvoice');
                const elevenlabsEngine = engines.find(e => e.id === 'elevenlabs' && e.available);

                let selectedEngine = engines[0]?.id;

                if (cosyvoiceEngine && cosyvoiceEngine.available) {
                    const isConnected = await checkCosyVoiceConnection();
                    if (!isConnected && elevenlabsEngine) {
                        console.warn('[TTS] CosyVoice ì—°ê²° ì‹¤íŒ¨ â†’ ElevenLabsë¡œ ìë™ ì „í™˜');
                        selectedEngine = 'elevenlabs';
                    } else if (isConnected) {
                        selectedEngine = 'cosyvoice';
                    }
                } else if (elevenlabsEngine) {
                    selectedEngine = 'elevenlabs';
                }

                const engineOptions = engines.map(e =>
                    `<option value="${e.id}" ${e.id === selectedEngine ? 'selected' : ''}>${e.name}</option>`
                ).join('');

                document.getElementById('ttsEngineSelect').innerHTML = engineOptions;
                document.getElementById('batchTtsEngineSelect').innerHTML = engineOptions;

                updateVoiceOptions();
                updateBatchVoiceOptions();

            } catch (error) {
                console.error('ì˜µì…˜ ë¡œë“œ ì˜¤ë¥˜:', error);
            }
        }

        // ìŒì„± ì˜µì…˜ ì—…ë°ì´íŠ¸
        function updateVoiceOptions() {
            const engineId = document.getElementById('ttsEngineSelect').value;
            const voiceSelect = document.getElementById('ttsVoiceSelect');
            updateVoiceSelect(engineId, voiceSelect);
        }

        function updateBatchVoiceOptions() {
            const engineId = document.getElementById('batchTtsEngineSelect').value;
            const voiceSelect = document.getElementById('batchTtsVoiceSelect');
            updateVoiceSelect(engineId, voiceSelect);
        }

        function updateVoiceSelect(engineId, voiceSelect) {
            if (!engineId || !ttsEngines[engineId]) {
                voiceSelect.innerHTML = '<option value="">ì—”ì§„ ì„ íƒ</option>';
                return;
            }

            const voices = ttsEngines[engineId].voices;
            if (Array.isArray(voices)) {
                voiceSelect.innerHTML = voices.map(voice =>
                    `<option value="${voice}">${voice}</option>`
                ).join('');
            } else {
                voiceSelect.innerHTML = Object.entries(voices).map(([id, name]) =>
                    `<option value="${id}">${name}</option>`
                ).join('');
            }
        }

        // í…ìŠ¤íŠ¸ ì˜ì—­ ì„¤ì •
        function setupTextareas() {
            const textarea = document.getElementById('scriptInput');
            const charCount = document.getElementById('charCount');

            textarea.addEventListener('input', () => {
                const len = textarea.value.length;
                charCount.textContent = `${len} / 1000ì`;
                charCount.className = len > 1000 ? 'char-count warning' : 'char-count';
            });

            const batchInput = document.getElementById('batchInput');
            batchInput.addEventListener('input', () => {
                const lines = parseBatchText(batchInput.value);
                document.getElementById('batchLineCount').textContent = `${lines.length}ê°œ í•­ëª©`;
            });
        }

        // ë°°ì¹˜ í…ìŠ¤íŠ¸ íŒŒì‹±
        function parseBatchText(text) {
            return text.split('\n')
                .map(line => line.trim())
                .filter(line => line && line !== '---' && !line.match(/^-+$/))
                .map(line => {
                    // ë²ˆí˜¸ ì ‘ë‘ì‚¬ ì œê±° (1. , 1) , 1: , (1) ë“±)
                    return line.replace(/^[\d]+[\.\)\:\-]\s*/, '').replace(/^\([\d]+\)\s*/, '').trim();
                })
                .filter(line => line.length > 0);
        }

        // ë°°ì¹˜ ì…ë ¥ íŒŒì‹± ë° ë¯¸ë¦¬ë³´ê¸°
        function parseBatchInput() {
            const text = document.getElementById('batchInput').value;
            batchItems = parseBatchText(text);

            const batchList = document.getElementById('batchList');

            if (batchItems.length === 0) {
                batchList.innerHTML = '<p style="color: #888; text-align: center; padding: 20px;">ì…ë ¥ëœ í•­ëª©ì´ ì—†ìŠµë‹ˆë‹¤</p>';
                return;
            }

            batchList.innerHTML = batchItems.map((item, index) => `
                <div class="batch-item" id="batchItem${index}">
                    <div class="number">${index + 1}</div>
                    <div class="info">
                        <div class="text">${escapeHtml(item)}</div>
                        <div class="meta" id="batchMeta${index}">ëŒ€ê¸° ì¤‘</div>
                    </div>
                    <div class="actions" id="batchActions${index}"></div>
                </div>
            `).join('');

            document.getElementById('batchLineCount').textContent = `${batchItems.length}ê°œ í•­ëª©`;
        }

        // HTML ì´ìŠ¤ì¼€ì´í”„
        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        // ë°°ì¹˜ ë…¹í™” ì‹œì‘
        async function startBatchRecording() {
            if (batchItems.length === 0) {
                parseBatchInput();
                if (batchItems.length === 0) {
                    alert('ë…¹í™”í•  í•­ëª©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                    return;
                }
            }

            batchRunning = true;
            batchCurrentIndex = 0;
            batchResults = new Array(batchItems.length).fill(null);

            document.getElementById('batchStartBtn').disabled = true;
            document.getElementById('batchStopBtn').disabled = false;
            document.getElementById('batchProgress').classList.add('active');
            document.getElementById('downloadAllBtn').style.display = 'none';

            updateBatchProgress();
            processNextBatchItem();
        }

        // ë°°ì¹˜ ë…¹í™” ì¤‘ì§€
        function stopBatchRecording() {
            batchRunning = false;
            document.getElementById('batchStopBtn').disabled = true;
            document.getElementById('batchProgressStatus').textContent = 'ì¤‘ì§€ ìš”ì²­ë¨... í˜„ì¬ ì‘ì—… ì™„ë£Œ í›„ ì¤‘ì§€ë©ë‹ˆë‹¤.';
        }

        // ë‹¤ìŒ ë°°ì¹˜ í•­ëª© ì²˜ë¦¬
        async function processNextBatchItem() {
            if (!batchRunning || batchCurrentIndex >= batchItems.length) {
                return;
            }

            const text = batchItems[batchCurrentIndex];
            const avatarPath = 'auto';  // ìë™ ì„ íƒ
            const ttsEngine = document.getElementById('batchTtsEngineSelect').value;
            const ttsVoice = document.getElementById('batchTtsVoiceSelect').value;
            const resolution = document.getElementById('batchResolutionSelect').value;
            const outputFormat = document.getElementById('batchFormatSelect').value;
            const frameSkip = parseInt(document.getElementById('batchFrameSkipSelect').value);

            updateBatchItemStatus(batchCurrentIndex, 'processing', 'ìš”ì²­ ì¤‘...');

            try {
                const response = await fetch('/api/record', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        text: text,
                        avatar_path: avatarPath,
                        tts_engine: ttsEngine,
                        tts_voice: ttsVoice,
                        resolution: resolution,
                        output_format: outputFormat,
                        frame_skip: frameSkip,
                        filename: `batch_${String(batchCurrentIndex + 1).padStart(3, '0')}`,
                        sid: clientSid
                    })
                });

                const result = await response.json();

                if (!result.success) {
                    throw new Error(result.error || 'ìš”ì²­ ì‹¤íŒ¨');
                }

            } catch (error) {
                console.error('ë°°ì¹˜ í•­ëª© ì²˜ë¦¬ ì˜¤ë¥˜:', error);
                batchResults[batchCurrentIndex] = {
                    success: false,
                    error: error.message
                };
                updateBatchItemStatus(batchCurrentIndex, 'error', 'ì˜¤ë¥˜: ' + error.message);

                batchCurrentIndex++;
                updateBatchProgress();

                if (batchCurrentIndex < batchItems.length && batchRunning) {
                    setTimeout(() => processNextBatchItem(), 500);
                } else {
                    finishBatchRecording();
                }
            }
        }

        // ë°°ì¹˜ í•­ëª© ìƒíƒœ ì—…ë°ì´íŠ¸
        function updateBatchItemStatus(index, status, message, videoUrl = null) {
            const item = document.getElementById(`batchItem${index}`);
            const meta = document.getElementById(`batchMeta${index}`);
            const actions = document.getElementById(`batchActions${index}`);

            if (!item) return;

            item.className = `batch-item ${status}`;
            meta.textContent = message;

            if (status === 'completed' && videoUrl) {
                actions.innerHTML = `
                    <button class="btn-play" onclick="playBatchVideo('${videoUrl}')">â–¶</button>
                    <button class="btn-download" onclick="downloadVideoUrl('${videoUrl}')">ğŸ“¥</button>
                `;
            }
        }

        // ë°°ì¹˜ ì§„í–‰ë¥  ì—…ë°ì´íŠ¸
        function updateBatchProgress() {
            const completed = batchResults.filter(r => r !== null).length;
            const total = batchItems.length;
            const percent = total > 0 ? (completed / total * 100) : 0;

            document.getElementById('batchProgressCount').textContent = `${completed} / ${total}`;
            document.getElementById('batchProgressFill').style.width = `${percent}%`;
        }

        // ë°°ì¹˜ ë…¹í™” ì™„ë£Œ
        function finishBatchRecording() {
            batchRunning = false;

            document.getElementById('batchStartBtn').disabled = false;
            document.getElementById('batchStopBtn').disabled = true;

            const successCount = batchResults.filter(r => r && r.success).length;
            const errorCount = batchResults.filter(r => r && !r.success).length;

            document.getElementById('batchProgressStatus').textContent =
                `ì™„ë£Œ! ì„±ê³µ: ${successCount}ê°œ, ì‹¤íŒ¨: ${errorCount}ê°œ`;

            if (successCount > 0) {
                document.getElementById('downloadAllBtn').style.display = 'block';
            }
        }

        // ë°°ì¹˜ ë¹„ë””ì˜¤ ì¬ìƒ
        function playBatchVideo(url) {
            const previewVideo = document.getElementById('previewVideo');
            previewVideo.src = url + '?' + Date.now();
            previewVideo.load();
            previewVideo.play();

            // ë‹¨ì¼ íƒ­ìœ¼ë¡œ ì „í™˜
            switchTab('single');
            currentVideoUrl = url;
            document.getElementById('downloadBtn').disabled = false;
            document.getElementById('copyUrlBtn').disabled = false;
        }

        // ì „ì²´ ë‹¤ìš´ë¡œë“œ (ê°œë³„ íŒŒì¼)
        function downloadAllVideos() {
            const successResults = batchResults.filter(r => r && r.success);

            if (successResults.length === 0) {
                alert('ë‹¤ìš´ë¡œë“œí•  ì˜ìƒì´ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }

            // ìˆœì°¨ì ìœ¼ë¡œ ë‹¤ìš´ë¡œë“œ (ë¸Œë¼ìš°ì € ì œí•œ ìš°íšŒ)
            successResults.forEach((result, index) => {
                setTimeout(() => {
                    downloadVideoUrl(result.url);
                }, index * 500);
            });
        }

        // === ë‹¨ì¼ ë…¹í™” í•¨ìˆ˜ë“¤ ===

        // ì˜ˆì‹œ í…ìŠ¤íŠ¸ ì„ íƒ
        function selectExampleText() {
            const select = document.getElementById('exampleTextSelect');
            const textarea = document.getElementById('scriptInput');
            if (select.value) {
                textarea.value = select.value;
                textarea.focus();
                // ê¸€ì ìˆ˜ ì—…ë°ì´íŠ¸
                document.getElementById('charCount').textContent = `${select.value.length} / 1000ì`;
                // ì„ íƒ í›„ ë“œë¡­ë‹¤ìš´ ì´ˆê¸°í™”
                select.selectedIndex = 0;
            }
        }

        async function generateVideo() {
            const text = document.getElementById('scriptInput').value.trim();
            if (!text) {
                alert('ëŒ€ì‚¬ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            if (text.length > 1000) {
                alert('í…ìŠ¤íŠ¸ê°€ ë„ˆë¬´ ê¹ë‹ˆë‹¤. 1000ì ì´ë‚´ë¡œ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            const avatarPath = 'auto';  // ìë™ ì„ íƒ
            const ttsEngine = document.getElementById('ttsEngineSelect').value;
            const ttsVoice = document.getElementById('ttsVoiceSelect').value;
            const resolution = document.getElementById('resolutionSelect').value;
            const outputFormat = document.getElementById('formatSelect').value;
            const frameSkip = parseInt(document.getElementById('frameSkipSelect').value);
            const filename = document.getElementById('filenameInput').value.trim();

            document.getElementById('generateBtn').disabled = true;
            document.getElementById('generateBtn').textContent = 'ìƒì„± ì¤‘...';
            document.getElementById('progressContainer').style.display = 'block';
            document.getElementById('progressFill').style.width = '0%';
            document.getElementById('statusText').textContent = 'ìš”ì²­ ì¤‘...';

            try {
                const response = await fetch('/api/record', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        text: text,
                        avatar_path: avatarPath,
                        tts_engine: ttsEngine,
                        tts_voice: ttsVoice,
                        resolution: resolution,
                        output_format: outputFormat,
                        frame_skip: frameSkip,
                        filename: filename || null,
                        sid: clientSid
                    })
                });

                const result = await response.json();

                if (!result.success) {
                    throw new Error(result.error || 'ìš”ì²­ ì‹¤íŒ¨');
                }

            } catch (error) {
                console.error('ìƒì„± ì˜¤ë¥˜:', error);
                document.getElementById('statusText').textContent = 'ì˜¤ë¥˜: ' + error.message;
                document.getElementById('generateBtn').disabled = false;
                document.getElementById('generateBtn').textContent = 'ğŸ¬ ì˜ìƒ ìƒì„±';
            }
        }

        function addVideoToList(data) {
            const videoList = document.getElementById('videoList');

            if (generatedVideos.length === 0) {
                videoList.innerHTML = '';
            }

            const videoInfo = {
                url: data.video_url,
                time: new Date().toLocaleTimeString(),
                duration: data.elapsed ? data.elapsed.toFixed(1) + 'ì´ˆ' : '-'
            };
            generatedVideos.unshift(videoInfo);

            const item = document.createElement('div');
            item.className = 'video-item';
            item.innerHTML = `
                <div class="info">
                    <div class="name">ì˜ìƒ ${generatedVideos.length}</div>
                    <div class="meta">${videoInfo.time} â€¢ ${videoInfo.duration}</div>
                </div>
                <div class="actions">
                    <button class="btn-play" onclick="playVideo('${videoInfo.url}')">â–¶</button>
                    <button class="btn-download" onclick="downloadVideoUrl('${videoInfo.url}')">ğŸ“¥</button>
                </div>
            `;
            videoList.insertBefore(item, videoList.firstChild);
        }

        function playVideo(url) {
            const previewVideo = document.getElementById('previewVideo');
            previewVideo.src = url + '?' + Date.now();
            previewVideo.loop = false;  // ìƒˆ ì˜ìƒ ë¡œë“œì‹œ ë°˜ë³µ ì´ˆê¸°í™”
            isLooping = false;  // ë°˜ë³µ ìƒíƒœ ì´ˆê¸°í™”
            previewVideo.load();
            previewVideo.play();
            currentVideoUrl = url;
            document.getElementById('downloadBtn').disabled = false;
            document.getElementById('copyUrlBtn').disabled = false;
            document.getElementById('loopBtn').disabled = false;
            // ë°˜ë³µ ë²„íŠ¼ ìƒíƒœ ì´ˆê¸°í™”
            const loopBtn = document.getElementById('loopBtn');
            loopBtn.textContent = 'ğŸ” ë°˜ë³µ ì¬ìƒ';
            loopBtn.style.background = '';
            loopBtn.style.color = '';
        }

        function downloadVideo() {
            if (currentVideoUrl) {
                downloadVideoUrl(currentVideoUrl);
            }
        }

        async function downloadVideoUrl(url) {
            // ë‹¤ìš´ë¡œë“œ ì „ì— íŒŒì¼ì„ ì˜êµ¬ ì €ì¥ (ìë™ ì •ë¦¬ ë°©ì§€)
            try {
                await fetch('/api/video/save', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ video_url: url })
                });
            } catch (e) {
                console.warn('íŒŒì¼ ì €ì¥ ì‹¤íŒ¨ (ë‹¤ìš´ë¡œë“œëŠ” ê³„ì†):', e);
            }

            const ext = url.includes('.webm') ? '.webm' : '.mp4';
            const a = document.createElement('a');
            a.href = url;
            a.download = 'avatar_video_' + Date.now() + ext;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
        }

        function copyVideoUrl() {
            if (currentVideoUrl) {
                const fullUrl = window.location.origin + currentVideoUrl;
                navigator.clipboard.writeText(fullUrl).then(() => {
                    const btn = document.getElementById('copyUrlBtn');
                    btn.textContent = 'âœ“ ë³µì‚¬ë¨';
                    setTimeout(() => {
                        btn.textContent = 'ğŸ”— URL ë³µì‚¬';
                    }, 2000);
                });
            }
        }

        function toggleLoop() {
            const video = document.getElementById('previewVideo');
            const btn = document.getElementById('loopBtn');
            isLooping = !isLooping;
            video.loop = isLooping;

            if (isLooping) {
                btn.textContent = 'ğŸ” ë°˜ë³µ ì¤‘';
                btn.style.background = '#4ecca3';
                btn.style.color = '#1a1a2e';
            } else {
                btn.textContent = 'ğŸ” ë°˜ë³µ ì¬ìƒ';
                btn.style.background = '';
                btn.style.color = '';
            }
            console.log('Loop toggled:', isLooping);
        }

        // ë¹„ë””ì˜¤ ì¢…ë£Œ ì‹œ ë°˜ë³µ ì¬ìƒ ì²˜ë¦¬ (video.loop ì†ì„± ë°±ì—…)
        document.addEventListener('DOMContentLoaded', function() {
            const video = document.getElementById('previewVideo');
            video.addEventListener('ended', function() {
                if (isLooping) {
                    video.currentTime = 0;
                    video.play();
                }
            });

            // ì—…ë¡œë“œ íƒ­ ì´ˆê¸°í™”
            initUploadTab();
        });

        // ========== ìºì‹œ ì—…ë¡œë“œ ê¸°ëŠ¥ ==========

        let uploadedVideoUrl = null;
        let uploadHistory = [];
        let selectedFile = null;

        // ì—…ë¡œë“œ íƒ­ ì´ˆê¸°í™”
        function initUploadTab() {
            // API í‚¤ ë¡œë“œ
            const savedApiKey = localStorage.getItem('videoCacheApiKey');
            if (savedApiKey) {
                document.getElementById('uploadApiKey').value = savedApiKey;
            }

            // ì—…ë¡œë“œ í…ìŠ¤íŠ¸ ê¸€ì ìˆ˜ ì¹´ìš´íŠ¸
            const uploadText = document.getElementById('uploadText');
            uploadText.addEventListener('input', () => {
                document.getElementById('uploadCharCount').textContent = `${uploadText.value.length}ì`;
            });

            // ë“œë˜ê·¸ ì•¤ ë“œë¡­ ì„¤ì •
            const dropZone = document.getElementById('fileDropZone');

            dropZone.addEventListener('dragover', (e) => {
                e.preventDefault();
                dropZone.classList.add('dragover');
            });

            dropZone.addEventListener('dragleave', (e) => {
                e.preventDefault();
                dropZone.classList.remove('dragover');
            });

            dropZone.addEventListener('drop', (e) => {
                e.preventDefault();
                dropZone.classList.remove('dragover');
                const files = e.dataTransfer.files;
                if (files.length > 0) {
                    handleFileSelection(files[0]);
                }
            });

            // ì—…ë¡œë“œ ê¸°ë¡ ë¡œë“œ
            const savedHistory = localStorage.getItem('uploadHistory');
            if (savedHistory) {
                uploadHistory = JSON.parse(savedHistory);
                renderUploadHistory();
            }
        }

        // íŒŒì¼ ì„ íƒ í•¸ë“¤ëŸ¬
        function handleFileSelect(event) {
            const file = event.target.files[0];
            if (file) {
                handleFileSelection(file);
            }
        }

        function handleFileSelection(file) {
            // íŒŒì¼ ìœ í˜• ê²€ì¦
            if (!file.type.match(/video\/(mp4|webm)/)) {
                alert('MP4 ë˜ëŠ” WebM íŒŒì¼ë§Œ ì—…ë¡œë“œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.');
                return;
            }

            // íŒŒì¼ í¬ê¸° ê²€ì¦ (100MB)
            const maxSize = 100 * 1024 * 1024;
            if (file.size > maxSize) {
                alert('íŒŒì¼ í¬ê¸°ê°€ 100MBë¥¼ ì´ˆê³¼í•©ë‹ˆë‹¤.');
                return;
            }

            selectedFile = file;

            // UI ì—…ë°ì´íŠ¸
            document.getElementById('fileDropZone').style.display = 'none';
            document.getElementById('selectedFile').style.display = 'flex';
            document.getElementById('selectedFileName').textContent = file.name;
            document.getElementById('selectedFileSize').textContent = formatFileSize(file.size);
        }

        function clearFileSelection() {
            selectedFile = null;
            document.getElementById('uploadVideoFile').value = '';
            document.getElementById('fileDropZone').style.display = 'block';
            document.getElementById('selectedFile').style.display = 'none';
        }

        function formatFileSize(bytes) {
            if (bytes < 1024) return bytes + ' B';
            if (bytes < 1024 * 1024) return (bytes / 1024).toFixed(1) + ' KB';
            return (bytes / (1024 * 1024)).toFixed(1) + ' MB';
        }

        // ìºì‹œì— ì—…ë¡œë“œ
        async function uploadVideoToCache() {
            const apiKey = document.getElementById('uploadApiKey').value.trim();
            const text = document.getElementById('uploadText').value.trim();
            const source = document.getElementById('uploadSource').value;

            // ê²€ì¦
            if (!apiKey) {
                alert('API í‚¤ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                document.getElementById('uploadApiKey').focus();
                return;
            }

            if (!text) {
                alert('ëŒ€ì‚¬ í…ìŠ¤íŠ¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                document.getElementById('uploadText').focus();
                return;
            }

            if (!selectedFile) {
                alert('ë¹„ë””ì˜¤ íŒŒì¼ì„ ì„ íƒí•´ì£¼ì„¸ìš”.');
                return;
            }

            // API í‚¤ ì €ì¥
            localStorage.setItem('videoCacheApiKey', apiKey);

            // UI ì—…ë°ì´íŠ¸
            document.getElementById('uploadBtn').disabled = true;
            document.getElementById('uploadBtn').textContent = 'ì—…ë¡œë“œ ì¤‘...';
            document.getElementById('uploadProgressContainer').style.display = 'block';
            document.getElementById('uploadProgressFill').style.width = '0%';
            document.getElementById('uploadStatusText').textContent = 'ì—…ë¡œë“œ ì¤€ë¹„ ì¤‘...';

            try {
                // FormData ìƒì„±
                const formData = new FormData();
                formData.append('text', text);
                formData.append('video', selectedFile);
                formData.append('source', source);

                // XMLHttpRequestë¡œ ì—…ë¡œë“œ (ì§„í–‰ë¥  ì¶”ì )
                const xhr = new XMLHttpRequest();

                xhr.upload.addEventListener('progress', (e) => {
                    if (e.lengthComputable) {
                        const percent = Math.round((e.loaded / e.total) * 100);
                        document.getElementById('uploadProgressFill').style.width = percent + '%';
                        document.getElementById('uploadProgressPercent').textContent = percent + '%';
                        document.getElementById('uploadStatusText').textContent =
                            percent < 100 ? 'ì—…ë¡œë“œ ì¤‘...' : 'ì„œë²„ ì²˜ë¦¬ ì¤‘...';
                    }
                });

                const result = await new Promise((resolve, reject) => {
                    xhr.onload = () => {
                        if (xhr.status >= 200 && xhr.status < 300) {
                            try {
                                resolve(JSON.parse(xhr.responseText));
                            } catch (e) {
                                reject(new Error('ì‘ë‹µ íŒŒì‹± ì˜¤ë¥˜'));
                            }
                        } else {
                            try {
                                const err = JSON.parse(xhr.responseText);
                                reject(new Error(err.error || `HTTP ${xhr.status}`));
                            } catch (e) {
                                reject(new Error(`HTTP ${xhr.status}`));
                            }
                        }
                    };
                    xhr.onerror = () => reject(new Error('ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜'));
                    xhr.ontimeout = () => reject(new Error('ìš”ì²­ ì‹œê°„ ì´ˆê³¼'));

                    xhr.open('POST', 'https://mindprep.co.kr/api/video-cache/upload');
                    xhr.setRequestHeader('X-API-Key', apiKey);
                    xhr.timeout = 300000; // 5ë¶„
                    xhr.send(formData);
                });

                if (result.success) {
                    // ì„±ê³µ
                    document.getElementById('uploadProgressFill').style.width = '100%';
                    document.getElementById('uploadStatusText').textContent = 'ì—…ë¡œë“œ ì™„ë£Œ!';

                    uploadedVideoUrl = result.video_url;

                    // ê²°ê³¼ í‘œì‹œ
                    document.getElementById('uploadResultEmpty').style.display = 'none';
                    document.getElementById('uploadResult').style.display = 'block';
                    document.getElementById('resultStatus').textContent = 'âœ… ì„±ê³µ';
                    document.getElementById('resultStatus').style.color = '#4caf50';
                    document.getElementById('resultCacheKey').textContent = result.cache_key || '-';
                    document.getElementById('resultSource').textContent = result.source || source;
                    document.getElementById('resultVideoUrl').textContent = result.video_url;
                    document.getElementById('resultVideoUrl').href = result.video_url;

                    // ê¸°ë¡ ì¶”ê°€
                    addToUploadHistory({
                        text: text.substring(0, 50) + (text.length > 50 ? '...' : ''),
                        source: source,
                        url: result.video_url,
                        cacheKey: result.cache_key,
                        time: new Date().toLocaleString()
                    });

                    // ì…ë ¥ ì´ˆê¸°í™”
                    document.getElementById('uploadText').value = '';
                    document.getElementById('uploadCharCount').textContent = '0ì';
                    clearFileSelection();

                } else {
                    throw new Error(result.error || 'ì—…ë¡œë“œ ì‹¤íŒ¨');
                }

            } catch (error) {
                console.error('ì—…ë¡œë“œ ì˜¤ë¥˜:', error);
                document.getElementById('uploadStatusText').textContent = 'ì˜¤ë¥˜: ' + error.message;
                document.getElementById('uploadProgressFill').style.width = '0%';

                // ê²°ê³¼ì— ì˜¤ë¥˜ í‘œì‹œ
                document.getElementById('uploadResultEmpty').style.display = 'none';
                document.getElementById('uploadResult').style.display = 'block';
                document.getElementById('resultStatus').textContent = 'âŒ ì‹¤íŒ¨: ' + error.message;
                document.getElementById('resultStatus').style.color = '#e74c3c';

            } finally {
                document.getElementById('uploadBtn').disabled = false;
                document.getElementById('uploadBtn').textContent = 'ğŸ“¤ ìºì‹œì— ì—…ë¡œë“œ';

                setTimeout(() => {
                    document.getElementById('uploadProgressContainer').style.display = 'none';
                }, 3000);
            }
        }

        // ì—…ë¡œë“œ ê¸°ë¡ ì¶”ê°€
        function addToUploadHistory(item) {
            uploadHistory.unshift(item);
            if (uploadHistory.length > 20) {
                uploadHistory = uploadHistory.slice(0, 20);
            }
            localStorage.setItem('uploadHistory', JSON.stringify(uploadHistory));
            renderUploadHistory();
        }

        // ì—…ë¡œë“œ ê¸°ë¡ ë Œë”ë§
        function renderUploadHistory() {
            const container = document.getElementById('uploadHistory');

            if (uploadHistory.length === 0) {
                container.innerHTML = '<p style="color: #888; text-align: center; padding: 15px;">ì—…ë¡œë“œ ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤</p>';
                return;
            }

            container.innerHTML = uploadHistory.map((item, index) => `
                <div class="video-item">
                    <div class="info">
                        <div class="name">${escapeHtml(item.text)}</div>
                        <div class="meta">${item.time} â€¢ ${item.source}</div>
                    </div>
                    <div class="actions">
                        <button class="btn-play" onclick="window.open('${item.url}', '_blank')">â–¶</button>
                        <button class="secondary" style="width:auto;padding:6px 10px;font-size:0.8em" onclick="copyToClipboard('${item.url}')">ğŸ”—</button>
                    </div>
                </div>
            `).join('');
        }

        // ì—…ë¡œë“œëœ URL ë³µì‚¬
        function copyUploadedUrl() {
            if (uploadedVideoUrl) {
                copyToClipboard(uploadedVideoUrl);
                const btn = event.target;
                const originalText = btn.textContent;
                btn.textContent = 'âœ“ ë³µì‚¬ë¨';
                setTimeout(() => { btn.textContent = originalText; }, 2000);
            }
        }

        // í´ë¦½ë³´ë“œ ë³µì‚¬
        function copyToClipboard(text) {
            navigator.clipboard.writeText(text).then(() => {
                console.log('í´ë¦½ë³´ë“œì— ë³µì‚¬ë¨:', text);
            }).catch(err => {
                console.error('ë³µì‚¬ ì‹¤íŒ¨:', err);
            });
        }

        // ì—…ë¡œë“œëœ ë¹„ë””ì˜¤ ë¯¸ë¦¬ë³´ê¸°
        function previewUploadedVideo() {
            if (uploadedVideoUrl) {
                window.open(uploadedVideoUrl, '_blank');
            }
        }
    </script>
</body>
</html>
